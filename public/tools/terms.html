<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- タイトルも動的に変更 -->
    <title data-lang="appTitle">利用規約同意機能付きアプリ</title>
    <!-- Tailwind CSSを読み込み、モダンなデザインを適用します -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
        }
        /* モーダル表示時に背景コンテンツをぼかすスタイル */
        #main-content.blurred {
            filter: blur(5px);
            transition: filter 0.3s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-100">

    <!-- アプリのメインコンテンツ（ダミー） -->
    <div id="main-content" class="container mx-auto p-8 transition-all duration-300">
        <h1 class="text-4xl font-bold text-gray-800 mb-4" data-lang="mainTitle">ようこそ！</h1>
        <p class="text-lg text-gray-600" data-lang="mainDescription">
            これはアプリケーションのメインコンテンツです。<br>
            利用規約に同意した後に、このコンテンツを操作できます。
        </p>
        <div class="mt-8 p-6 bg-white rounded-xl shadow-md">
            <h2 class="text-2xl font-semibold mb-2" data-lang="dummyTitle">ダミー機能</h2>
            <p data-lang="dummyDescription">ここにアプリの機能が表示されます。</p>
            <button class="mt-4 px-4 py-2 bg-blue-500 text-white font-semibold rounded-lg shadow-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-75" data-lang="sampleButton">
                サンプルボタン
            </button>
        </div>
    </div>

    <!-- 利用規約モーダル -->
    <div id="terms-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col">
            <div class="p-6 border-b border-gray-200">
                <h2 class="text-2xl font-bold text-gray-800" data-lang="modalTitle">利用規約</h2>
            </div>
            
            <!-- 利用規約の本文（スクロール可能） -->
            <div id="terms-content" class="p-6 overflow-y-auto text-sm text-gray-700">
                <!-- この中身はJavaScriptによって動的に挿入されます -->
            </div>
            
            <div class="p-6 border-t border-gray-200 bg-gray-50 rounded-b-2xl">
                <div class="flex items-center mb-4">
                    <input id="agree-checkbox" type="checkbox" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                    <label for="agree-checkbox" class="ml-3 block text-sm font-medium text-gray-800" data-lang="agreeCheckboxLabel">利用規約に同意します</label>
                </div>
                <button id="agree-button" disabled class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 disabled:bg-gray-400 disabled:cursor-not-allowed disabled:shadow-none transition-all duration-300 transform hover:scale-105" data-lang="agreeButton">
                    同意して利用を開始する
                </button>
            </div>
        </div>
    </div>

<script>
    // --- 設定項目 ---
    const LATEST_TERMS_VERSION = '2025-06-27'; 
    const STORAGE_KEY = 'termsAgreedVersion';

    // --- 多言語対応テキスト ---
    const translations = {
        // 日本語のテキスト
        ja: {
            appTitle: "利用規約同意機能付きアプリ",
            mainTitle: "ようこそ！",
            mainDescription: "これはアプリケーションのメインコンテンツです。<br>利用規約に同意した後に、このコンテンツを操作できます。",
            dummyTitle: "ダミー機能",
            dummyDescription: "ここにアプリの機能が表示されます。",
            sampleButton: "サンプルボタン",
            modalTitle: "利用規約",
            agreeCheckboxLabel: "利用規約に同意します",
            agreeButton: "同意して利用を開始する",
            termsContent: `
                <p class="text-sm text-gray-500 mb-4">このサービスをご利用になる前に、以下の利用規約をよくお読みください。</p>
                <div class="space-y-4">
                    <p><strong>第1条（本規約の適用）</strong><br>本利用規約（以下「本規約」といいます。）は、[あなたのサービス名]（以下「本サービス」といいます。）の利用に関する条件を定めるものです。本サービスを利用するすべてのユーザー（以下「ユーザー」といいます。）は、本規約に同意の上、本サービスを利用するものとします。本規約のバージョンは <strong>${LATEST_TERMS_VERSION}</strong> です。</p>
                    <p><strong>第2条（本サービスの目的）</strong><br>本サービスは、[サービスの簡単な説明]を目的として提供されます。</p>
                    <p><strong>第3条（禁止事項）</strong><br>ユーザーは、本サービスの利用にあたり、以下の各号のいずれかに該当する行為または該当すると判断される行為をしてはなりません。<br>1. 法令に違反する行為または犯罪行為に関連する行為<br>2. 公序良俗に反する行為<br>3. 本サービスのネットワークまたはシステム等に過度な負荷をかける行為<br>4. 本サービスの運営を妨害するおそれのある行為</p>
                    <p><strong>第4条（免責事項）</strong><br>本サービスの利用によりユーザーに何らかの損害が生じた場合であっても、当方は故意または重過失による場合を除き、一切の責任を負わないものとします。</p>
                    <p><strong>第5条（利用規約の変更）</strong><br>当方は、必要と判断した場合には、ユーザーに通知することなくいつでも本規約を変更することができるものとします。変更後の本規約は、本サービス上に掲載された時点から効力を生じるものとし、ユーザーは変更後の規約に同意したものとみなされます。</p>
                    <p><strong>第6条（準拠法・裁判管轄）</strong><br>本規約の解釈にあたっては、日本法を準拠法とします。本サービスに関して紛争が生じた場合には、[あなたの所在地]を管轄する裁判所を第一審の専属的合意管轄裁判所とします。</p>
                    <p>附則<br>制定日：2025年6月27日</p>
                </div>`
        },
        // 英語のテキスト
        en: {
            appTitle: "App with Terms of Service Agreement",
            mainTitle: "Welcome!",
            mainDescription: "This is the main content of the application.<br>You can interact with this content after agreeing to the terms of service.",
            dummyTitle: "Dummy Feature",
            dummyDescription: "App features will be displayed here.",
            sampleButton: "Sample Button",
            modalTitle: "Terms of Service",
            agreeCheckboxLabel: "I agree to the Terms of Service",
            agreeButton: "Agree and Start",
            termsContent: `
                <p class="text-sm text-gray-500 mb-4">Please read the following terms of service carefully before using this service.</p>
                <div class="space-y-4">
                    <p><strong>Article 1 (Application of These Terms)</strong><br>These Terms of Service ("Terms") set forth the conditions for using [Your Service Name] ("Service"). All users ("Users") of the Service must agree to these Terms before using the Service. The version of these terms is <strong>${LATEST_TERMS_VERSION}</strong>.</p>
                    <p><strong>Article 2 (Purpose of the Service)</strong><br>This Service is provided for the purpose of [brief description of the service].</p>
                    <p><strong>Article 3 (Prohibited Actions)</strong><br>Users must not engage in any of the following acts, or acts deemed to fall under any of the following, when using the Service:<br>1. Acts that violate laws or are related to criminal activity.<br>2. Acts that are contrary to public order and morals.<br>3. Acts that place an excessive load on the Service's network or systems.<br>4. Acts that may interfere with the operation of the Service.</p>
                    <p><strong>Article 4 (Disclaimer)</strong><br>We shall not be liable for any damage incurred by the User through the use of the Service, except in cases of willful misconduct or gross negligence on our part.</p>
                    <p><strong>Article 5 (Changes to the Terms of Service)</strong><br>We may change these Terms at any time without notifying the User if deemed necessary. The modified Terms shall take effect from the time they are posted on the Service, and the User shall be deemed to have agreed to the modified Terms.</p>
                    <p><strong>Article 6 (Governing Law and Jurisdiction)</strong><br>The interpretation of these Terms shall be governed by the laws of Japan. Any disputes arising in connection with the Service shall be subject to the exclusive jurisdiction of the court governing [Your Location] in the first instance.</p>
                    <p>Addendum<br>Date of Enactment: June 27, 2025</p>
                </div>`
        }
    };

    // --- DOM要素の取得 ---
    const modal = document.getElementById('terms-modal');
    const mainContent = document.getElementById('main-content');
    const agreeCheckbox = document.getElementById('agree-checkbox');
    const agreeButton = document.getElementById('agree-button');
    const termsContent = document.getElementById('terms-content');

    // --- 関数 ---
    /**
     * 指定された言語のテキストをページに適用する
     * @param {string} lang - 言語コード ('ja' または 'en')
     */
    function applyLanguage(lang) {
        const langPack = translations[lang];
        if (!langPack) return; // 対応言語がない場合は何もしない

        // data-lang属性を持つすべての要素のテキストを更新
        document.querySelectorAll('[data-lang]').forEach(el => {
            const key = el.dataset.lang;
            if (langPack[key]) {
                // title属性を持つ要素（<title>タグなど）はtextContentで更新
                if (el.tagName.toLowerCase() === 'title') {
                    el.textContent = langPack[key];
                } else {
                    el.innerHTML = langPack[key];
                }
            }
        });

        // 利用規約の本文を挿入
        termsContent.innerHTML = langPack.termsContent;
    }

    function showModal() {
        modal.classList.remove('hidden');
        mainContent.classList.add('blurred');
    }

    function hideModal() {
        modal.classList.add('hidden');
        mainContent.classList.remove('blurred');
    }

    // --- メインロジック ---
    window.addEventListener('load', () => {
        // 1. ブラウザの言語を判定し、テキストを適用
        const userLang = navigator.language || navigator.userLanguage;
        const lang = userLang.startsWith('ja') ? 'ja' : 'en';
        applyLanguage(lang);

        // 2. localStorageから同意済みのバージョンを取得
        const agreedVersion = localStorage.getItem(STORAGE_KEY);

        // 3. 同意済みのバージョンが最新でない場合、モーダルを表示
        if (agreedVersion !== LATEST_TERMS_VERSION) {
            showModal();
        }
    });

    // --- イベントリスナー ---
    agreeCheckbox.addEventListener('change', () => {
        agreeButton.disabled = !agreeCheckbox.checked;
    });

    agreeButton.addEventListener('click', () => {
        localStorage.setItem(STORAGE_KEY, LATEST_TERMS_VERSION);
        hideModal();
    });

</script>
</body>
</html>
